<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="js/jquery.min.js"></script>
    <title>checked</title>
</head>
<body>
    <form action="">
        <input type="checkbox" name="All" value="0"><span>All</span>
        <input type="checkbox" name="check" value="台北"><span>台北</span>
        <input type="checkbox" name="check" value="新竹"><span>新竹</span>
        <input type="checkbox" name="check" value="台中"><span>台中</span>
        <input type="checkbox" name="check" value="台南"><span>台南</span>
        <input type="checkbox" name="check" value="高雄"><span>高雄</span>
    </form>
    <div class="save"></div>
    <button class="cancel">取消</button>

    <script>
        let p;  //所選的checkbox
        let str = '';  //所選的值
        let arr = new Array();  //陣列 存放目前所選的值 (以便日後判斷使用者要取消的是哪個選項 要刪除的是哪個值)
        let temp = [];  //存入取消某選項後的新字串
        // let sep = ",";

        $("input[name='All']").click(function(){
            if($(this).prop('checked')){
                p = $("input[name='check']").attr('checked',true);
                console.log(p);
                $("input[name='check']").each(function(i,j){
                    temp.push(j.value);
                    let str = temp .join(',');
                    console.log(str);
                    $('.save').text(str);
                });
            }else {
                $("input[name='check']").removeAttr('checked');
                $("input[name='check']").removeProp('checked');
                temp = [];
                str = '';
                $(".save").empty();
                console.log($(".save").text());
            };
            
        });
        $("input[name='check']").change(function(){
            if($(this).prop('checked')){  //選取
                p = $(this).attr('checked',true);
                str += $(this).val() + ",";
                $(".save").text(str);
            }else {  //取消選取
                temp = '';
                p.removeAttr("checked");
                str = str.substring(0, str.length-1);
                arr = str.split(",");  //用空字串 切割字串
                for(var i = 0; i< arr.length; i++){
                    if($(this).val() == arr[i]){
                        console.log("使用者選擇的值: "+arr[i]);
                        arr[i] = '';  //取消值
                    }
                    if(arr[i] != ''){
                        temp += arr[i]+",";  //將陣列的值重新串起來成字串
                    }
                }
                str = temp;
                $(".save").text(str);
            }
        });
        $(".cancel").click(function(){
            $("input[type='checkbox']").prop('checked',false);
            $("input[type='checkbox']").removeAttr("checked");
            str = '';
            temp = '';
            $(".save").empty();
        });
                    // $("input[type=checkbox]:checked").removeProp("checked");
        
                // });
                // let str = $(".save").html();
        
                // $("input[type=checkbox]").change(function(){
                //     console.log($("input:checked").val());
                //     $("input[type=checkbox]").prop("check","checked");
                // });
                // $(document).ready(function p(){
                    $('input:checkbox:checked[name="check"]').map(function(){
                        str += checked;
                        $('.save').append(str);
                        return $(this).val(); }).get();
                // });
                // console.log(p);
            </script>
        <!-- Code injected by live-server -->
        


    <!-- <div>
        <input type="checkbox" name="check" value="新竹">1 
        <input type="checkbox" name="check" value="台北">2
        <input type="checkbox" name="check" value="台南">3
        <input type="checkbox" name="check" value="台中">4
        <input type="checkbox" name="check" value="高雄">5
    </div>
    <div class="save"></div>
    <button class="cancel">取消</button>

    <script>
        let checked = '';
        $("input[type='checkbox']").change(function(){
            let p = $(this).attr('checked',true);
            if($(this).prop('checked')){
                checked = $(this).val();
                console.log(checked);
                let str = $(".save").html();
                str +=  $(this).val() + " / ";
                $(".save").text(str);
            }else {
                $(this).removeAttr('checked');
                $(".save").remove($(this).val());
            }
        });
        $(".cancel").click(function(){
            $("input[type='checkbox']").prop('checked',false);
            $("input[type='checkbox']").removeAttr('checked');
            $(".save").empty();
            // console.log($("input:checked"));
        });
            // $("input[type=checkbox]:checked").removeProp("checked");
            
        // });
        // let str = $(".save").html();

        // $("input[type=checkbox]").change(function(){
        //     console.log($("input:checked").val());
        //     $("input[type=checkbox]").prop("check","checked");
        // });
        // $(document).ready(function p(){
            $('input:checkbox:checked[name="check"]').map(function(){ 
                str += checked;
                $('.save').append(str);
                return $(this).val(); }).get();
        // });
        // console.log(p);
    </script> -->
</body>
</html>